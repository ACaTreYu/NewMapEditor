---
phase: 89-platform-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [electron/main.ts, electron/platform.ts]
autonomous: true

must_haves:
  truths:
    - "All 5 top-level menu labels have & prefix for Alt-key accelerators on Linux/Windows"
    - "No macOS-only menu roles (appMenu, services, hide, unhide) exist in the menu template"
    - "XDG path compliance is documented in platform.ts with dev-mode logging on Linux"
  artifacts:
    - path: "electron/main.ts"
      provides: "Menu labels with & prefix"
      contains: "&File"
    - path: "electron/platform.ts"
      provides: "XDG path documentation and dev logging helper"
      contains: "getUserDataPath"
  key_links:
    - from: "electron/main.ts"
      to: "electron/platform.ts"
      via: "import { isLinux } for platform-conditional dev logging"
      pattern: "import.*platform"
---

<objective>
Add Linux menu accelerator conventions (& prefixes) and document XDG path compliance.

Purpose: Satisfy PLAT-01 (XDG paths) and PLAT-04 (Linux menu conventions) requirements. XDG paths are already handled by Electron's defaults -- this plan verifies and documents that. The menu needs & prefixes for Alt-key navigation on Linux/Windows.

Output: Updated buildMenu() with & prefixes on all 5 top-level labels, getUserDataPath() helper in platform.ts with dev-mode XDG logging.
</objective>

<execution_context>
@C:\Users\arcje\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\arcje\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/89-platform-polish/89-RESEARCH.md
@.planning/phases/88-build-architecture/88-01-SUMMARY.md
@electron/platform.ts
@electron/main.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add menu & prefixes and XDG path verification</name>
  <files>electron/main.ts, electron/platform.ts</files>
  <action>
  **In electron/platform.ts:**

  1. Add imports at the top: `import { app } from 'electron';`
  2. Add a `getUserDataPath()` export function that returns `app.getPath('userData')`. This documents that Electron already uses XDG on Linux (no manual override needed). Include a JSDoc comment explaining that on Linux this returns `~/.config/ac-map-editor` (XDG_CONFIG_HOME/appName).
  3. Add a `logPlatformPaths()` export function that, when called, logs `app.getPath('userData')` and `app.getPath('appData')` to console. Guard the logging behind `isDev && isLinux` inside the function body. Include a JSDoc explaining this is for dev-mode verification of XDG compliance. The function accepts an `isDev: boolean` parameter so it does not import isDev from main.ts (avoids circular dependency).

  **In electron/main.ts (buildMenu function):**

  4. Change all 5 top-level menu labels to include `&` prefix:
     - `'File'` -> `'&File'`
     - `'Edit'` -> `'&Edit'`
     - `'View'` -> `'&View'`
     - `'Window'` -> `'&Window'`
     - `'Help'` -> `'&Help'`

  These `&` prefixes generate Alt+F, Alt+E, Alt+V, Alt+W, Alt+H keyboard accelerators on Linux and Windows. On macOS, the `&` is stripped by the native menu system and has no effect. No platform guard is needed.

  5. After the `createWindow()` call inside `app.whenReady().then()`, add a call to `logPlatformPaths(isDev)` imported from `./platform`. This logs XDG paths in dev mode on Linux for human verification.

  **Do NOT:**
  - Add `app.setPath('userData', ...)` or any manual XDG path construction
  - Add `role: 'appMenu'` or any macOS-specific menu roles
  - Modify any submenu items or accelerators (they are already correct with CmdOrCtrl)
  </action>
  <verify>
  Run `npm run typecheck` from the project root. It must pass with zero errors.
  Manually verify in electron/main.ts that all 5 labels start with `&`.
  Manually verify in electron/platform.ts that getUserDataPath() and logPlatformPaths() exist.
  </verify>
  <done>
  All 5 top-level menu labels have & prefix. platform.ts exports getUserDataPath() with XDG documentation and logPlatformPaths() for dev verification. Typecheck passes.
  </done>
</task>

</tasks>

<verification>
1. `npm run typecheck` passes with no errors
2. Grep for `label: '&File'` in electron/main.ts confirms & prefix
3. Grep for `label: '&Edit'` in electron/main.ts confirms & prefix
4. Grep for `label: '&View'` in electron/main.ts confirms & prefix
5. Grep for `label: '&Window'` in electron/main.ts confirms & prefix
6. Grep for `label: '&Help'` in electron/main.ts confirms & prefix
7. Grep for `getUserDataPath` in electron/platform.ts confirms export exists
8. No `app.setPath` calls exist in the codebase (Electron defaults are correct)
9. No `role: 'appMenu'` exists in electron/main.ts
</verification>

<success_criteria>
- PLAT-01 satisfied: XDG path compliance verified and documented (Electron handles it by default)
- PLAT-04 satisfied: Menu has & prefixes for Alt-key accelerators, no macOS-only roles present
- Typecheck passes
- No regressions to Windows menu behavior (& is harmless on Windows, adds Alt accelerators)
</success_criteria>

<output>
After completion, create `.planning/phases/89-platform-polish/89-01-SUMMARY.md`
</output>
