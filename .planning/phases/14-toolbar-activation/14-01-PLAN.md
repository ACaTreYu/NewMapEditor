---
phase: 14-toolbar-activation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ToolBar/ToolBar.tsx
autonomous: true

must_haves:
  truths:
    - "SPAWN tool button visible in toolbar and activates SPAWN tool on click"
    - "SWITCH tool button visible in toolbar and activates SWITCH tool on click"
    - "BRIDGE tool button visible in toolbar and activates BRIDGE tool on click"
    - "Keyboard shortcut S activates SPAWN tool"
    - "Keyboard shortcut H activates SWITCH tool (W is taken by WALL)"
    - "Keyboard shortcut J activates BRIDGE tool (B is taken by PENCIL)"
    - "GameObjectToolPanel shows options when SPAWN, SWITCH, or BRIDGE are active"
    - "All three tools place game objects on map when clicked"
  artifacts:
    - path: "src/components/ToolBar/ToolBar.tsx"
      provides: "Toolbar button registration for SPAWN, SWITCH, BRIDGE"
      contains: "ToolType.SPAWN"
  key_links:
    - from: "src/components/ToolBar/ToolBar.tsx"
      to: "src/components/MapCanvas/MapCanvas.tsx"
      via: "setTool dispatches ToolType.SPAWN/SWITCH/BRIDGE which MapCanvas already handles"
      pattern: "ToolType\\.SPAWN|ToolType\\.SWITCH|ToolType\\.BRIDGE"
    - from: "src/components/ToolBar/ToolBar.tsx"
      to: "src/components/GameObjectToolPanel/GameObjectToolPanel.tsx"
      via: "currentTool change triggers GameObjectToolPanel conditional renders"
      pattern: "GAME_OBJECT_TOOLS\\.has\\(currentTool\\)"
---

<objective>
Add SPAWN, SWITCH, and BRIDGE tool buttons to the toolbar so users can access all existing game object tools.

Purpose: These three tools are fully implemented in GameObjectSystem.ts with event handling in MapCanvas.tsx and options UI in GameObjectToolPanel.tsx, but they have no toolbar buttons -- making them completely inaccessible to users. This plan adds the missing toolbar entries.

Output: Three new toolbar buttons with icons and keyboard shortcuts, completing game object tool accessibility.
</objective>

<execution_context>
@C:\Users\arcje\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\arcje\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-toolbar-activation/14-RESEARCH.md
@src/components/ToolBar/ToolBar.tsx
@src/core/map/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Register SPAWN, SWITCH, BRIDGE in toolbar arrays</name>
  <files>src/components/ToolBar/ToolBar.tsx</files>
  <action>
Add three tool entries to the existing toolbar arrays in ToolBar.tsx:

1. Add SPAWN to `gameObjectStampTools` array (after WARP entry, line ~33):
   ```typescript
   { tool: ToolType.SPAWN, label: 'Spawn', icon: '\u2B50', shortcut: 'S' },
   ```

2. Add SWITCH to `gameObjectStampTools` array (after SPAWN):
   ```typescript
   { tool: ToolType.SWITCH, label: 'Switch', icon: '\u{1F518}', shortcut: 'H' },
   ```

3. Add BRIDGE to `gameObjectRectTools` array (after HOLDING_PEN entry, line ~38):
   ```typescript
   { tool: ToolType.BRIDGE, label: 'Bridge', icon: '\u{1F309}', shortcut: 'J' },
   ```

**Keyboard shortcut rationale:**
- S for SPAWN: Plain 'S' is available. Ctrl+S handles save via early return in the keyboard handler, so plain 'S' has no conflict. This matches the roadmap's intent.
- H for SWITCH: 'W' is already assigned to WALL tool. 'H' is unused by any tool shortcut (the theme display shows H/W/D but those are display-only labels, not shortcuts).
- J for BRIDGE: 'B' is already assigned to PENCIL tool (historically "Brush"). 'J' is unused.

**Why this works with zero other changes:**
- `allToolsWithShortcuts` (line 46) already spreads `...gameObjectStampTools` and `...gameObjectRectTools`, so keyboard shortcuts auto-register.
- The toolbar render loops (lines 194-204 for stamps, 209-219 for rects) already iterate these arrays, so buttons auto-render.
- MapCanvas.tsx already checks for ToolType.SPAWN, ToolType.SWITCH in stamp tool handling and ToolType.BRIDGE in rect tool handling.
- GameObjectToolPanel.tsx already has SPAWN/SWITCH/BRIDGE in GAME_OBJECT_TOOLS, CUSTOM_DAT_TOOLS, and TEAM_TOOLS sets, with conditional render blocks for each.
- Canvas cursor preview already includes SPAWN and SWITCH in the stampTools Set.

**Do NOT:**
- Modify MapCanvas.tsx (already handles these tools)
- Modify GameObjectToolPanel.tsx (already has UI for these tools)
- Modify types.ts (ToolType enum already has SPAWN, SWITCH, BRIDGE)
- Modify EditorState.ts (gameObjectToolState already has spawnType, switchType, bridgeDir)
- Add any new files or components
  </action>
  <verify>
1. Run `npm run typecheck` -- must pass with zero errors
2. Run `npm run electron:dev` -- app must launch
3. Visually confirm: toolbar shows Spawn, Switch, Bridge buttons in correct groups (Spawn/Switch with Flag/Pole/Warp; Bridge with Bunker/H.Pen)
4. Click each button: tool activates (button shows sunken/active state)
5. Press S key: SPAWN tool activates
6. Press H key: SWITCH tool activates
7. Press J key: BRIDGE tool activates
8. Activate SPAWN: GameObjectToolPanel shows team selector and type dropdown
9. Activate SWITCH: GameObjectToolPanel shows type dropdown
10. Activate BRIDGE: GameObjectToolPanel shows direction dropdown
11. With map loaded: click on map with SPAWN active -- places game object (3x3 cursor preview visible)
12. With map loaded: drag on map with BRIDGE active -- draws rectangle preview
  </verify>
  <done>
All three tool buttons (SPAWN, SWITCH, BRIDGE) appear in toolbar with correct icons and labels. Keyboard shortcuts S, H, J activate the respective tools. Clicking/dragging on map with each tool active triggers the corresponding game object placement. GameObjectToolPanel shows appropriate options for each tool.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>SPAWN, SWITCH, and BRIDGE tool buttons added to toolbar with keyboard shortcuts S, H, J</what-built>
  <how-to-verify>
1. Look at toolbar -- three new buttons should appear:
   - "Spawn" (star icon) in the game object stamp group (with Flag, Pole, Warp)
   - "Switch" (radio button icon) in the same stamp group
   - "Bridge" (bridge icon) in the game object rect group (with Bunker, H.Pen)
2. Click each button -- it should show sunken/active state
3. Press S, H, J keys -- should activate Spawn, Switch, Bridge respectively
4. Verify existing shortcuts still work: W=Wall, B=Pencil, F=Flag, etc.
5. With a map loaded, try clicking with Spawn active -- should show 3x3 cursor preview
6. With a map loaded, try dragging with Bridge active -- should show rectangle preview

Note on keyboard shortcuts: The roadmap specified S/W/B but W (Wall) and B (Pencil) were already taken. S works as-is. H and J were chosen as alternatives for Switch and Bridge.
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues</resume-signal>
</task>

</tasks>

<verification>
- `npm run typecheck` passes
- App launches without errors via `npm run electron:dev`
- All three new buttons render in correct toolbar groups
- Keyboard shortcuts S, H, J work without conflicting with existing shortcuts
- Existing tool shortcuts (V, B, G, L, R, W, E, I, F, P, T, K, N, Q, A) still work
- GameObjectToolPanel shows correct options for each new tool
- Map canvas responds to tool actions (stamp for SPAWN/SWITCH, rect drag for BRIDGE)
</verification>

<success_criteria>
- SPAWN tool accessible via toolbar button (star icon) and 'S' shortcut
- SWITCH tool accessible via toolbar button (radio icon) and 'H' shortcut
- BRIDGE tool accessible via toolbar button (bridge icon) and 'J' shortcut
- All three tools function correctly: place game objects on map
- No regressions in existing tool shortcuts or behavior
</success_criteria>

<output>
After completion, create `.planning/phases/14-toolbar-activation/14-01-SUMMARY.md`
</output>
