---
phase: 78-cleanup-code-quality
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/core/map/AnimationDefinitions.old.ts
  - src/components/MapCanvas/MapCanvas.tsx
  - src/core/canvas/CanvasEngine.ts
autonomous: true

must_haves:
  truths:
    - "AnimationDefinitions.old.ts no longer exists in the codebase"
    - "TypeScript compiler reports zero TS6133 unused variable warnings"
    - "Empty stale phase directories 16-marquee-selection and 20-animation-panel-redesign are removed"
  artifacts:
    - path: "src/components/MapCanvas/MapCanvas.tsx"
      provides: "Clean code without immediatePatchTile or unused event params"
    - path: "src/core/canvas/CanvasEngine.ts"
      provides: "Clean code without unused dirty tracking object"
  key_links:
    - from: "src/components/MapCanvas/MapCanvas.tsx"
      to: "npm run typecheck"
      via: "TypeScript compilation"
      pattern: "zero TS6133 errors"
---

<objective>
Remove all dead code: delete AnimationDefinitions.old.ts (272-line orphaned file), remove 2 empty stale phase directories, and fix all 4 TypeScript TS6133 unused variable warnings.

Purpose: Eliminate technical debt — dead code confuses future maintainers and unused variables indicate vestigial logic from old rendering architecture.
Output: Clean codebase with zero TypeScript unused variable warnings.
</objective>

<execution_context>
@C:\Users\arcje\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\arcje\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/78-cleanup-code-quality/78-RESEARCH.md
@src/components/MapCanvas/MapCanvas.tsx
@src/core/canvas/CanvasEngine.ts
@src/core/map/AnimationDefinitions.old.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete dead files and empty directories</name>
  <files>
    src/core/map/AnimationDefinitions.old.ts
    .planning/phases/16-marquee-selection/
    .planning/phases/20-animation-panel-redesign/
  </files>
  <action>
1. Verify AnimationDefinitions.old.ts has zero imports anywhere in the codebase:
   ```bash
   grep -r "AnimationDefinitions.old" src/
   ```
   Must return zero results. If any imports exist, do NOT delete — report the issue instead.

2. Delete the orphaned file:
   ```bash
   rm src/core/map/AnimationDefinitions.old.ts
   ```

3. Verify the two phase directories are truly empty (contain only `.` and `..`):
   ```bash
   ls -la .planning/phases/16-marquee-selection/
   ls -la .planning/phases/20-animation-panel-redesign/
   ```

4. Remove the empty directories:
   ```bash
   rmdir .planning/phases/16-marquee-selection
   rmdir .planning/phases/20-animation-panel-redesign
   ```
  </action>
  <verify>
- `ls src/core/map/AnimationDefinitions.old.ts` returns "No such file"
- `ls .planning/phases/16-marquee-selection` returns "No such file or directory"
- `ls .planning/phases/20-animation-panel-redesign` returns "No such file or directory"
- `npm run typecheck` still compiles (no broken imports)
  </verify>
  <done>AnimationDefinitions.old.ts deleted, both empty phase directories removed, no broken imports.</done>
</task>

<task type="auto">
  <name>Task 2: Remove all unused TypeScript variables</name>
  <files>
    src/components/MapCanvas/MapCanvas.tsx
    src/core/canvas/CanvasEngine.ts
  </files>
  <action>
Fix all 4 TS6133 warnings identified by `npm run typecheck`:

**1. MapCanvas.tsx line ~208 — Remove `immediatePatchTile` useCallback entirely:**
This entire useCallback function is declared but never called. Delete the full `const immediatePatchTile = useCallback(...)` block (including the closing `], []);`). The function was vestigial from a pre-CanvasEngine rendering approach.

**2. MapCanvas.tsx line ~1968 — Remove unused `e` parameter:**
Find the function signature containing an unused `e: React.MouseEvent` parameter around line 1968. The `e` parameter is not used in the function body. Either:
- Remove the parameter if no callers pass it, OR
- Prefix with underscore: `_e: React.MouseEvent` to signal intentionally unused

Check the call site to determine which approach is correct. If the parameter is passed by a React event handler (like `onMouseDown`), keep it as `_e` since React passes the event automatically. If it's a manual call, remove it.

**3. MapCanvas.tsx line ~2067 — Remove unused `e` parameter:**
Same pattern as #2. Find the unused `e: MouseEvent` around line 2067, prefix with `_e` or remove depending on call site.

**4. CanvasEngine.ts line ~47 — Remove `dirty` property:**
Delete the entire `private dirty = { mapBuffer: false, mapBlit: false, uiOverlay: false };` property declaration. This object was part of an old dirty-tracking rendering system that was replaced by the current subscription-based approach. It is never read anywhere in the class.
  </action>
  <verify>
Run `npm run typecheck` — must produce zero TS6133 errors. The output should show no "is declared but its value is never read" warnings.
  </verify>
  <done>All 4 TypeScript TS6133 unused variable warnings eliminated. `npm run typecheck` reports zero unused variable errors.</done>
</task>

</tasks>

<verification>
1. `npm run typecheck` outputs zero TS6133 errors (no unused variables)
2. `ls src/core/map/AnimationDefinitions.old.ts` fails (file deleted)
3. `ls .planning/phases/16-marquee-selection` fails (directory removed)
4. `ls .planning/phases/20-animation-panel-redesign` fails (directory removed)
5. Application still builds and runs: `npm run electron:dev` starts without errors
</verification>

<success_criteria>
- AnimationDefinitions.old.ts is deleted from disk
- Both empty phase directories (16, 20) are removed
- TypeScript compiler reports zero TS6133 warnings
- No other TypeScript errors introduced by the changes
- Requirements CLEAN-01, CLEAN-02, CLEAN-03 satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/78-cleanup-code-quality/78-01-SUMMARY.md`
</output>
