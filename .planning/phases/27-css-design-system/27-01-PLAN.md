---
phase: 27-css-design-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/variables.css
  - src/App.css
  - src/styles/win98-variables.css
  - src/styles/win98-bevels.css
  - src/styles/win98-typography.css
  - src/styles/win98-schemes.css
  - src/hooks/useTheme.ts
  - src/components/ToolBar/ToolBar.tsx
  - src/components/MapSettingsPanel/MapSettingsPanel.tsx
autonomous: true

must_haves:
  truths:
    - "Editor loads with light neutral color palette (white/light grey backgrounds, dark text)"
    - "Body uses system font stack (not MS Sans Serif bitmap font)"
    - "Win98 theme CSS files no longer exist on disk"
    - "Win98 color scheme toggle is removed from toolbar and settings panel"
    - "CSS design tokens for spacing, radius, shadows, and colors are defined in variables.css"
  artifacts:
    - path: "src/styles/variables.css"
      provides: "Modern design token system (OKLCH colors, 8px grid, system fonts, radius, shadows, semantic aliases)"
      contains: "--color-neutral-"
    - path: "src/App.css"
      provides: "Global styles with modern imports and body typography"
      contains: "variables.css"
  key_links:
    - from: "src/App.css"
      to: "src/styles/variables.css"
      via: "@import"
      pattern: "@import.*variables\\.css"
    - from: "src/styles/variables.css"
      to: ":root"
      via: "CSS custom properties"
      pattern: "--surface:|--text-primary:|--bg-primary:"
---

<objective>
Create the modern CSS design token foundation and remove the Win98 theme infrastructure.

Purpose: Establish the single source of truth for all design tokens (colors, spacing, typography, radius, shadows) using modern CSS patterns. Remove the Win98 variable system, color schemes, bevel classes, and bitmap typography that will be replaced.

Output: New variables.css with complete modern token system, updated App.css with modern imports and body styles, deleted Win98 CSS files, removed theme toggle mechanism.
</objective>

<execution_context>
@C:\Users\arcje\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\arcje\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-css-design-system/27-RESEARCH.md
@src/styles/win98-variables.css
@src/App.css
@src/hooks/useTheme.ts
@src/components/ToolBar/ToolBar.tsx
@src/components/MapSettingsPanel/MapSettingsPanel.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create modern variables.css and update App.css foundation</name>
  <files>
    src/styles/variables.css
    src/App.css
  </files>
  <action>
Create `src/styles/variables.css` with the complete modern design token system from the research document. This file replaces win98-variables.css as the single source of truth for all design tokens.

The file MUST contain all of these sections in :root:

**Tier 1 - Color Primitives (OKLCH):**
- Neutral palette: --color-neutral-0 (100% pure white), --color-neutral-50 (98% off-white), --color-neutral-100 (95%), --color-neutral-200 (90%), --color-neutral-300 (80%), --color-neutral-500 (60%), --color-neutral-700 (35%), --color-neutral-900 (20%)
- Use slight cool tone (chroma 0.005, hue 280) for neutrals 100-700
- Accent blue: --color-blue-400 (70% 0.12 250), --color-blue-500 (60% 0.15 250), --color-blue-600 (50% 0.15 250)

**Tier 1 - Spacing (8px grid):**
- --space-0 through --space-10: 0, 8px, 16px, 24px, 32px, 40px, 48px, 64px, 80px

**Tier 1 - Typography:**
- --font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif
- --font-mono: ui-monospace, 'Cascadia Code', Menlo, Monaco, 'Courier New', monospace
- Font sizes: --font-size-xs (11px), --font-size-sm (13px), --font-size-base (14px), --font-size-lg (16px), --font-size-xl (18px)
- Font weights: normal (400), medium (500), semibold (600), bold (700)
- Line heights: tight (1.25), normal (1.5), relaxed (1.75)

**Tier 1 - Border Radius:**
- --radius-none (0), --radius-sm (4px), --radius-md (6px), --radius-lg (8px), --radius-full (9999px)

**Tier 1 - Shadows (rgba, NOT oklch):**
- --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05)
- --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)
- --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)
- --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)
- --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)

**Tier 2 - Semantic Aliases (MUST preserve ALL existing semantic variable names from win98-variables.css):**
- Surface: --surface (neutral-0), --surface-secondary (neutral-50), --surface-light (neutral-100)
- Text: --text-primary (neutral-900), --text-secondary (neutral-700), --text-tertiary (neutral-500), --text-disabled (neutral-300)
- Background: --bg-primary (neutral-0), --bg-secondary (neutral-50), --bg-tertiary (neutral-100), --bg-hover (neutral-100), --bg-active (neutral-200), --bg-window (neutral-0)
- Border: --border-default (neutral-300), --border-subtle (neutral-200), --border-light (neutral-100), --border-dark (neutral-700), --border-emphasis (neutral-500)
- Accent: --accent-primary (blue-500), --accent-hover (blue-600), --accent-active (blue-600)
- Scrollbar: --scrollbar-track (neutral-100), --scrollbar-thumb (neutral-300), --scrollbar-thumb-hover (neutral-500)
- Input: --input-bg (neutral-0), --input-border (neutral-300), --input-focus (blue-500)
- Slider: --slider-track (neutral-300), --slider-thumb (neutral-0), --slider-thumb-active (neutral-50)
- Workspace: --workspace-bg (neutral-200)

Then update `src/App.css`:
1. Replace the four Win98 @import lines with a single: `@import './styles/variables.css';`
2. Update the comment at top from "Win98 Themed Base Styles" to "Modern Minimalist Base Styles"
3. Update body styles to add: `font-family: var(--font-sans);`, `font-size: var(--font-size-base);`, `-webkit-font-smoothing: antialiased;` (replacing the -webkit-font-smoothing: none from win98-typography.css)
4. Replace ALL var(--win98-*) references in App.css with appropriate semantic variables:
   - var(--win98-ButtonDkShadow) in .win95-frame-inset borders -> var(--border-dark)
   - var(--win98-ButtonHighlight) in .win95-frame-inset borders -> var(--border-light)
   - Panel title bar gradients: Replace Win98 caption variables with accent colors. Use flat background instead of gradient: `background: var(--bg-tertiary);` for inactive, `background: var(--accent-primary);` for active. Update text colors accordingly.
   - var(--win98-ButtonFace) -> var(--surface) for resize handles
   - var(--win98-ButtonHighlight) borders -> var(--border-light) or var(--border-subtle)
   - var(--win98-ButtonShadow) borders -> var(--border-default)
5. Update panel title bar styling: Remove gradient, use flat background with modern font. Replace `font-family: "Pixelated MS Sans Serif"...` with `font-family: var(--font-sans);`. Update font-size from 11px to var(--font-size-sm). Add border-radius: var(--radius-sm) to panel title bars.
6. Update resize handles: Replace beveled border pattern with simple 1px border using var(--border-default).
  </action>
  <verify>
Run `npm run typecheck` to verify no TypeScript errors introduced. Open the file and verify all sections are present. Run `grep -c "win98" src/App.css` and confirm 0 matches. Run `grep -c "win98" src/styles/variables.css` and confirm 0 matches.
  </verify>
  <done>
variables.css exists with complete token system (colors, spacing, typography, radius, shadows, semantic aliases). App.css imports only variables.css (no win98 imports). Zero var(--win98-*) references remain in App.css. Body uses system font with antialiased rendering.
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete Win98 CSS files and remove theme toggle</name>
  <files>
    src/styles/win98-variables.css
    src/styles/win98-bevels.css
    src/styles/win98-typography.css
    src/styles/win98-schemes.css
    src/hooks/useTheme.ts
    src/components/ToolBar/ToolBar.tsx
    src/components/MapSettingsPanel/MapSettingsPanel.tsx
  </files>
  <action>
**Step 1: Delete Win98 CSS files** (4 files):
- Delete `src/styles/win98-variables.css`
- Delete `src/styles/win98-bevels.css`
- Delete `src/styles/win98-typography.css`
- Delete `src/styles/win98-schemes.css`

**Step 2: Delete useTheme hook:**
- Delete `src/hooks/useTheme.ts`

**Step 3: Remove theme toggle from ToolBar.tsx:**
- Remove the import: `import { useTheme, Win98Scheme } from '../../hooks/useTheme';`
- Remove the `Win98Scheme` type from any type arrays
- Remove the `const { scheme, setScheme } = useTheme();` line
- Remove the `const cycleScheme` function and its `order` array (approximately lines 119-123)
- Remove the theme toggle button from the JSX (the button with `title={`Theme: ${scheme}...`}`)
- Make sure the ToolBar still compiles cleanly after removal

**Step 4: Remove theme toggle from MapSettingsPanel.tsx:**
- Remove the import: `import { useTheme, Win98Scheme } from '../../hooks/useTheme';`
- Remove the `const { scheme, setScheme } = useTheme();` line
- Remove any scheme-related UI elements (scheme selector dropdown, cycle button, etc.)
- Make sure the component still compiles cleanly after removal

**Step 5: Check for any remaining references:**
- Search for any remaining imports of useTheme or Win98Scheme across the codebase
- Search for any remaining references to `theme-high-contrast` or `theme-desert` CSS classes in JS/TS files
- Remove any remaining references found

NOTE: Do NOT delete the `assets/fonts/` directory in this plan. Font cleanup is a separate concern and keeping unused fonts on disk is harmless.
  </action>
  <verify>
Run `npm run typecheck` - must pass with zero errors. Verify the 4 Win98 CSS files no longer exist: `ls src/styles/` should only show `variables.css`. Verify `src/hooks/useTheme.ts` no longer exists. Run `grep -r "useTheme\|Win98Scheme\|win98-variables\|win98-bevels\|win98-typography\|win98-schemes" src/ --include="*.ts" --include="*.tsx" --include="*.css"` and confirm zero matches (excluding any comments).
  </verify>
  <done>
All 4 Win98 CSS files deleted. useTheme hook deleted. Theme toggle removed from ToolBar and MapSettingsPanel. Zero references to Win98 CSS files, useTheme, or Win98Scheme remain in codebase. TypeScript compiles cleanly.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run typecheck` - zero TypeScript errors
2. Run `npm run electron:dev` - app launches with light neutral colors, system font visible
3. Verify `src/styles/` contains only `variables.css` (no win98-*.css files)
4. Verify `src/hooks/useTheme.ts` does not exist
5. Search codebase for `var(--win98-` in App.css - zero matches
6. Confirm body text renders in system font (not pixel MS Sans Serif)
</verification>

<success_criteria>
- variables.css contains complete modern design token system (OKLCH colors, 8px spacing, system fonts, radius, shadows)
- App.css imports only variables.css
- All 4 Win98 CSS files are deleted
- useTheme hook and Win98 scheme toggle are removed
- Body uses system-ui font with antialiased rendering
- Zero var(--win98-*) references in App.css
</success_criteria>

<output>
After completion, create `.planning/phases/27-css-design-system/27-01-SUMMARY.md`
</output>
