---
phase: 02-layout-and-toolbar
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.css
  - src/components/ToolBar/ToolBar.tsx
  - src/components/ToolBar/ToolBar.css
autonomous: true

must_haves:
  truths:
    - "User sees toolbar with icon + label for each tool"
    - "Active tool appears visually pressed/sunken"
    - "Hovering tool shows border indication"
    - "Theme colors follow OS dark/light preference"
  artifacts:
    - path: "src/App.css"
      provides: "CSS custom properties for theming"
      contains: "prefers-color-scheme"
    - path: "src/components/ToolBar/ToolBar.tsx"
      provides: "Toolbar with icon + label below pattern"
      contains: "toolbar-label"
    - path: "src/components/ToolBar/ToolBar.css"
      provides: "Pressed button effect for active tool"
      contains: "box-shadow: inset"
  key_links:
    - from: "src/components/ToolBar/ToolBar.css"
      to: "src/App.css"
      via: "CSS custom properties"
      pattern: "var\\(--"
---

<objective>
Implement theme system with CSS custom properties and redesign toolbar to use icon + label below pattern with pressed/sunken active state.

Purpose: Establishes visual foundation for professional editor appearance - theme variables used throughout, toolbar sets visual language for tool interactions.

Output: Theme-aware CSS variables in App.css, redesigned ToolBar with icon + label buttons and 3D pressed effect for active tools.
</objective>

<execution_context>
@C:\Users\arcje\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\arcje\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-layout-and-toolbar/02-CONTEXT.md
@.planning/phases/02-layout-and-toolbar/02-RESEARCH.md

@src/App.css
@src/components/ToolBar/ToolBar.tsx
@src/components/ToolBar/ToolBar.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CSS custom properties with system theme support</name>
  <files>src/App.css</files>
  <action>
Add CSS custom properties to App.css in :root selector for theming. Define variables for:
- --bg-primary: main background (#1a1a2e dark, #ffffff light)
- --bg-secondary: panel/toolbar background (#2a2a3e dark, #f5f5f5 light)
- --bg-active: active button background (#4a4a6e dark, #e0e0e0 light)
- --border-color: panel borders (#3a3a4e dark, #e0e0e0 light)
- --text-primary: main text (#cccccc dark, #000000 light)
- --text-secondary: muted text (#888888 dark, #666666 light)
- --accent-color: highlights (#5a5a7e dark, #0066cc light)

Add @media (prefers-color-scheme: dark) and (prefers-color-scheme: light) queries to override values.

Update existing hardcoded colors in App.css body and .app rules to use the new variables:
- body background-color: var(--bg-primary)
- body color: var(--text-primary)

Keep existing layout rules (display: flex, height: 100%, etc.) unchanged.
  </action>
  <verify>
Run `npm run typecheck` - should pass (CSS changes only).
Inspect App.css - should contain :root with CSS variables and @media prefers-color-scheme queries.
  </verify>
  <done>
App.css has CSS custom properties for theming with automatic dark/light mode switching based on OS preference.
  </done>
</task>

<task type="auto">
  <name>Task 2: Redesign ToolBar with icon + label and pressed effect</name>
  <files>src/components/ToolBar/ToolBar.tsx, src/components/ToolBar/ToolBar.css</files>
  <action>
**ToolBar.tsx changes:**

1. Update button rendering to show icon with label below. Change the tool button JSX from just `{tool.icon}` to:
```tsx
<span className="toolbar-icon">{tool.icon}</span>
<span className="toolbar-label">{tool.label}</span>
```

2. Keep existing tool definitions (tools array with tool, label, icon, shortcut).

3. Keep all existing functionality: keyboard shortcuts, file operations, undo/redo, grid toggle, etc.

4. Remove the toolbar-section grouping dividers - all tools should be in one continuous row with equal spacing per CONTEXT.md decision "Single row, no grouping".

5. Move file operations (new, open, save), undo/redo, and utility buttons (grid, animations, settings) to be inline with tools - one continuous row.

**ToolBar.css changes:**

1. Update .toolbar to use CSS variables:
   - background-color: var(--bg-secondary)
   - border-bottom: 1px solid var(--border-color)

2. Update .toolbar-button for icon + label layout:
```css
.toolbar-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  padding: 6px 8px;
  min-width: 50px;
  border: 1px solid transparent;
  border-radius: 4px;
  background: transparent;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}
```

3. Add hover state with faint border:
```css
.toolbar-button:hover:not(:disabled) {
  border-color: var(--border-color);
  color: var(--text-primary);
}
```

4. Add pressed/sunken active state per CONTEXT.md:
```css
.toolbar-button.active {
  background-color: var(--bg-active);
  border-color: var(--border-color);
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
  transform: translateY(1px);
  color: var(--text-primary);
}
```

5. Add .toolbar-icon and .toolbar-label styles:
```css
.toolbar-icon {
  font-size: 18px;
  line-height: 1;
}

.toolbar-label {
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}
```

6. Remove .toolbar-divider (no longer used with single row design).

7. Keep .toolbar-spacer and .toolbar-info styles, update colors to use variables.
  </action>
  <verify>
Run `npm run typecheck` - should pass.
Run `npm run electron:dev` - toolbar should display with:
- All buttons in single row
- Icon above label for each tool
- Active tool appears pressed (inset shadow, slight down shift)
- Hover shows border outline
  </verify>
  <done>
Toolbar redesigned with icon + label below pattern, pressed/sunken active state, and uses CSS custom properties for theming.
  </done>
</task>

</tasks>

<verification>
1. `npm run typecheck` passes
2. `npm run electron:dev` launches successfully
3. Theme colors adapt to OS dark/light mode preference
4. Toolbar shows icon + label for each tool button
5. Active tool has visible pressed/sunken appearance
6. Hovering inactive tools shows border indication
</verification>

<success_criteria>
- Theme system implemented with CSS custom properties
- All colors respond to OS dark/light mode via prefers-color-scheme
- Toolbar uses icon + label below pattern for all tool buttons
- Active tool has 3D pressed effect (inset shadow + translateY)
- Hover state shows faint border
- All existing keyboard shortcuts and functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/02-layout-and-toolbar/02-01-SUMMARY.md`
</output>
