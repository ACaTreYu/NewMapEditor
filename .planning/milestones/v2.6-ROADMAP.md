# Milestone v2.6: Viewport & Animation Fixes

**Status:** SHIPPED 2026-02-11
**Phases:** 44-46
**Total Plans:** 3

## Overview

Fix animation rendering bug, pan sensitivity, and add professional zoom controls. Three focused bug-fix and feature phases completing the viewport navigation experience.

## Phases

### Phase 44: Animation Visibility Fix

**Goal**: Animations render correctly at all zoom levels (0.25x to 4x), not just at extreme zoom-out
**Depends on**: Nothing (first phase of milestone)
**Requirements**: VIEW-01, PERF-01
**Plans**: 1 plan

Plans:
- [x] 44-01-PLAN.md -- Fix hasVisibleAnimatedTiles() coordinate math + visual verification

**Success Criteria:**
  1. User places animated tile at viewport center at 1x zoom and sees animation playing
  2. User zooms to 0.25x (full map visible) and all animated tiles continue animating
  3. User zooms to 4x (close-up) and animated tiles render without artifacts
  4. No unnecessary canvas redraws when viewport contains zero animated tiles

### Phase 45: Pan Sensitivity Fix

**Goal**: Pan drag moves map 1:1 with mouse movement at all zoom levels (no over/under-sensitivity)
**Depends on**: Phase 44 complete (viewport bugs isolated)
**Requirements**: VIEW-02
**Plans**: 1 plan

Plans:
- [x] 45-01-PLAN.md -- Cursor-anchored panning replacing delta-based approach

**Success Criteria:**
  1. User right-click drags 100px at zoom 0.25x and map moves 100px on screen
  2. User right-click drags 100px at zoom 1x and map moves 100px on screen
  3. User right-click drags 100px at zoom 4x and map moves 100px on screen
  4. All tools (pencil, wall, select) click on correct tile after pan sensitivity fix

### Phase 46: Zoom Controls UI

**Goal**: Professional zoom controls in status bar (slider, input, presets, keyboard shortcuts)
**Depends on**: Phase 44, 45 complete (viewport navigation working correctly)
**Requirements**: ZOOM-01, ZOOM-02, ZOOM-03, ZOOM-04, ZOOM-05
**Plans**: 1 plan

Plans:
- [x] 46-01-PLAN.md -- Zoom slider, input, presets, and keyboard shortcuts in StatusBar

**Success Criteria:**
  1. User types "150" in zoom input field and viewport zooms to 150%
  2. User drags zoom slider and viewport zoom updates in real-time
  3. User clicks "50%" preset button and viewport zooms to 50%
  4. User presses Ctrl+0 and viewport resets to 100% zoom
  5. User presses Ctrl+= and viewport zooms in by 25% (or to next preset)
  6. User presses Ctrl+- and viewport zooms out by 25% (or to previous preset)
  7. User scrolls mouse wheel and zoom-to-cursor behavior continues working
  8. Zoom controls disable at min/max limits (25% and 400%)

---

## Milestone Summary

**Key Decisions:**
- Phase 44: viewport.x/y are tile coordinates -- never divide by TILE_SIZE*zoom in hasVisibleAnimatedTiles()
- Phase 44: Used 1920x1080 conservative canvas estimate since AnimationPanel lacks canvas ref
- Phase 45: dragAnchor stores tile coordinates for cursor-anchored panning -- viewport recalculated each move
- Phase 46: All zoom controls sync through setViewport({ zoom }) -- single source of truth
- Phase 46: Preset buttons show active state when within 0.01 of preset value (floating point tolerance)
- Phase 46: Keyboard shortcuts skip to next/previous preset, fallback to +/- 0.25 increments

**Issues Resolved:**
- Animation tiles only visible at extreme zoom-out (coordinate math bug in hasVisibleAnimatedTiles)
- Pan drag over/under-sensitivity at different zoom levels (delta-based approach replaced with cursor-anchored)
- No UI controls for precise zoom level setting (only mouse wheel existed)

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
