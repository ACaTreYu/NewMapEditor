# Milestone v3.5: Warp Expansion & Cleanup

**Status:** SHIPPED 2026-02-16
**Phases:** 77-78
**Total Plans:** 4

## Overview

Made all 6 warp types (F6-FA, 9E) fully functional with routing, added visual warp type previews to dropdown, and cleaned up dead code, hardcoded CSS values, and unused variables.

## Phases

### Phase 77: Warp Tool Expansion

**Goal**: All 6 warp types (F6-FA, 9E) encode routing and appear in dropdown with tile previews
**Depends on**: Phase 76
**Plans**: 2 plans

Plans:

- [x] 77-01: Core logic — parameterize encodeWarpTile, replace warpVariant with warpType, extend picker to all 6 types
- [x] 77-02: UI — warp tile preview generation, 6-type dropdown, CSS styling

**Details:**
- Replaced binary warp variant toggle (0/1) with indexed warp type selector (0-5) backed by WARP_STYLES array
- Parameterized encodeWarpTile to accept animId parameter instead of hardcoded 0xFA
- Extended picker decoding from 2 warp types (FA, 9E) to all 6 via WARP_STYLES.includes(animId)
- Added warp dropdown to toolbar with tile image previews for all 6 types following wall preview pattern
- useMemo-cached canvas rendering extracts first frame from ANIMATION_DEFINITIONS for each warp type

### Phase 78: Cleanup & Code Quality

**Goal**: Codebase cleaned of dead code, hardcoded values replaced with design tokens, duplicate utilities extracted
**Depends on**: Phase 77
**Plans**: 2 plans

Plans:

- [x] 78-01: Dead code removal — delete AnimationDefinitions.old.ts, empty phase dirs, fix 4 TS6133 unused variable warnings
- [x] 78-02: CSS design token migration — add --color-error, --gradient-title-bar, --surface-hover-overlay tokens, replace ~15 hardcoded values

**Details:**
- Deleted 272-line orphaned AnimationDefinitions.old.ts (zero imports)
- Removed empty phase directories 16-marquee-selection and 20-animation-panel-redesign
- Removed unused immediatePatchTile useCallback, dirty tracking, prefixed unused event params with underscore
- Added 3 new design tokens (--color-error, --gradient-title-bar, --surface-hover-overlay) to variables.css
- Replaced 15 hardcoded hex/rgba values across 3 component CSS files with tokens
- CODE-01 (duplicate centering math) marked N/A — research grep found zero instances

---

## Milestone Summary

**Key Decisions:**

- WARP_STYLES array is single source of truth for 6 warp types (F6-FA, 9E), warpType default is 4 (0xFA) for backward compat
- React event handlers with unused params prefixed with underscore (_e) to silence TS6133 while maintaining type contract
- All CSS colors flow from variables.css tokens (OKLCH two-tier system) - zero hardcoded colors in component CSS

**Issues Resolved:**

- All 6 warp types now encode routing (previously only FA did)
- Zero TypeScript unused variable warnings (previously 4)
- Zero hardcoded colors in component CSS (previously 15)

**Issues Deferred:**

- CODE-01 duplicate centering math — research found zero instances, requirement invalid

**Technical Debt Incurred:**

- None — this was a cleanup milestone that reduced tech debt

---

_For current project status, see .planning/ROADMAP.md_
