# Milestone v1.1.2-linux: Linux Port & Cross-Platform Architecture

**Status:** SHIPPED 2026-02-18
**Phases:** 88-90
**Total Plans:** 3 formal + 1 ad-hoc

## Overview

Ship a Linux .deb build (same v1.1.2 as Windows) with platform-appropriate conventions and a clean cross-platform build architecture. Dual-platform downloads live on arcboundinteractive.com.

## Phases

### Phase 88: Build Architecture
**Goal:** The app builds as a Linux AppImage and the build system is organized for multi-platform targets
**Depends on:** Phase 87 (existing Windows build)
**Plans:** 1 plan

Plans:
- [x] 88-01: Add cross-platform build scripts, create electron/platform.ts, verify builds

**Details:**
- Created `electron/platform.ts` with `isMac`, `isLinux`, `isWindows` constants and `registerWindowAllClosed()` helper
- Added `electron:build:win` and `electron:build:linux` scripts to package.json
- Removed all `process.platform` references from `electron/main.ts`
- Verified Windows build produces working installer with no regression

### Phase 89: Platform Polish
**Goal:** The Linux build behaves correctly on Linux -- proper file paths, working auto-update, and correct menu
**Depends on:** Phase 88 (working Linux build)
**Plans:** 2 plans

Plans:
- [x] 89-01: Add menu & prefixes for Alt-key accelerators, verify/document XDG path compliance
- [x] 89-02: Wire Linux AppImage auto-updater relaunch via execFile(APPIMAGE)

**Details:**
- Added `&` prefix to all 5 top-level menu labels for Linux Alt-key navigation
- Documented Electron's built-in XDG compliance via `getUserDataPath()` and `logPlatformPaths()`
- Added `tryLinuxAppImageRelaunch()` for Linux AppImage auto-update relaunch
- Defensive mkdirSync for userData directory before marker file write

### Phase 90: Distribution (AD-HOC)
**Goal:** Linux users can discover, download, and stay updated via the same channels as Windows users
**Depends on:** Phase 89 (polished Linux build)
**Plans:** 1 ad-hoc (executed interactively without formal PLAN.md)

**Details:**
- Linux sandbox fix: afterPack wrapper script (rename binary, shell wrapper with --no-sandbox)
- Switched from AppImage to .deb for user-friendly double-click install on Ubuntu/Debian
- build/icon.png + gitignore exceptions for electron-builder Linux icon
- App category set to Graphics, author + email in package.json (required for .deb metadata)
- Patch folder dialog: extraResources for browsable patches directory outside asar
- Trimmed bundled patches to 10 curated sets
- Website archive.html: dual-platform download cards + separate changelog section
- Windows installer rebuilt with extraResources patches
- Both builds uploaded to arcboundinteractive.com via FileZilla

---

## Milestone Summary

**Key Decisions:**
- .deb over AppImage: double-click install via Ubuntu Software Center, adds to app menu
- --no-sandbox via wrapper script: Ubuntu 24.04 AppArmor blocks ALL sandbox approaches (SUID, namespace). app.commandLine.appendSwitch is too late (SUID check before Node.js). Wrapper script is the only reliable method.
- extraResources for patches: extracted outside asar so OS file dialog can browse them
- 10 curated patches only (reduced from 33): AC Default, forest-patch, Gold, H-Front, High Contrast, Sierra ARC, Spark 3D, waves-patch, Retro Patch, TEN Patch
- No app.setPath() override needed -- Electron handles XDG natively on Linux
- All process.platform checks consolidated to electron/platform.ts

**Issues Resolved:**
- Ubuntu 24.04 AppArmor blocking Chromium sandbox for non-system packages
- Asset PNGs blocked by *.png in .gitignore (added explicit exceptions)
- .deb requiring author email in package.json
- Patch folder dialog crash on read-only AppImage filesystem
- Patches inside asar not browsable by OS file dialog

**Issues Deferred:**
- macOS build (no current need)
- Snap/Flatpak packaging (AppImage/.deb covers most users)
- CI/CD pipeline (building locally for now)

**Technical Debt Incurred:**
- Phase 90 has no formal PLAN.md/SUMMARY.md (executed ad-hoc during interactive session)
- AppImage auto-updater relaunch wiring may be unused now that .deb is the target (kept for future flexibility)

---

_For current project status, see .planning/ROADMAP.md_
