# Milestone v2.5: Selection Transform Tools

**Status:** SHIPPED 2026-02-11
**Phases:** 41-43
**Total Plans:** 4

## Overview

Added 6 in-place selection transform tools (rotate CW/CCW, half-mirror in 4 directions) as toolbar buttons with undo/redo support, replacing clipboard-based Ctrl+H/J/R transforms. Restructured toolbar with separate action buttons, disabled states, and dedicated clipboard buttons.

## Phases

### Phase 41: Rotation Tools

**Goal**: User can rotate selected tiles in-place with 4 rotation options (90°, -90°, 180°, -180°)
**Depends on**: Phase 40
**Requirements**: ROT-01, ROT-02, ROT-03, ROT-04, ROT-05, ROT-06
**Plans**: 1 plan

Plans:

- [x] 41-01: Rotation algorithms, documentsSlice action, toolbar UI

**Details:**
- Created SelectionTransforms.ts with pure rotation algorithms using transpose+reverse pattern
- Implemented rotateSelectionForDocument action with full undo/redo support
- Added ROTATE toolbar button with 4-variant dropdown (90° CW, 90° CCW, 180°, -180°)
- Selection bounds automatically resize to fit rotated dimensions (e.g., 3x5 to 5x3 for 90°)
- Out-of-bounds tiles near map edges silently clipped

### Phase 42: Mirror Tools

**Goal**: User can mirror selected tiles in 4 directions with adjacent copy placement
**Depends on**: Phase 41
**Requirements**: MIR-01, MIR-02, MIR-03, MIR-04, MIR-05
**Plans**: 1 plan

Plans:

- [x] 42-01: Mirror algorithms, documentsSlice action, toolbar UI

**Details:**
- Pure mirror algorithms in SelectionTransforms.ts (mirrorHorizontal, mirrorVertical, mirror dispatcher)
- mirrorSelectionForDocument action with adjacent copy pattern (original stays, mirrored copy placed adjacent)
- MIRROR toolbar button with 4-direction variant dropdown (Right, Left, Up, Down)
- Selection expansion to encompass both original and mirrored copy
- Full undo/redo support via delta-based undo system

### Phase 43: Integration & Cleanup

**Goal**: Transform operations integrate with undo/redo and replace old clipboard-based shortcuts
**Depends on**: Phase 42
**Requirements**: INT-01, INT-02, INT-03
**Plans**: 2 plans

Plans:

- [x] 43-01: Dead code removal (old clipboard transforms, eraser, 180° rotation, Ctrl+H/J/R)
- [x] 43-02: Toolbar UI restructure (rotate CW/CCW split, clipboard buttons, reorder, disabled states, remove single-letter shortcuts)

**Details:**
- Removed all old clipboard transform functions (mirrorClipboardHorizontal, mirrorClipboardVertical, rotateClipboard)
- Removed ERASER tool completely (enum, toolbar, canvas, icon)
- Removed redundant 180° and -180° rotation options
- Split ROTATE dropdown into separate CW/CCW action buttons
- Added Cut/Copy/Paste toolbar buttons with dedicated icons
- Disabled states for all transform/clipboard buttons
- Removed all single-letter keyboard shortcuts
- 5 new toolbar SVG icons (rotate-cw, rotate-ccw, cut, copy, paste)

---

## Milestone Summary

**Key Decisions:**

- In-place rotation pattern: extract selection, apply algorithm, clear original, write back, update bounds
- Adjacent copy pattern for mirror: original stays, mirrored copy placed adjacent, selection expands
- Action button with variants: executes immediately without tool mode change
- Transpose+reverse algorithm for 90° rotations (mathematically correct and efficient)
- Removed 180°/-180° as redundant (use 90° twice instead)
- Split ROTATE dropdown into separate CW/CCW buttons for faster access
- Removed all single-letter keyboard shortcuts (Ctrl+ shortcuts preserved)

**Issues Resolved:**

- Old clipboard-based transforms completely replaced by in-place selection transforms
- ERASER tool removed (dead code since v1.6 SELECT tool)
- Unused eraseTile import cleaned up after ERASER removal
- Rotation direction corrected (fix commit 1b4695f)
- Mirror selection kept active after operation (fix commit 1b4695f)
- Static selection rect used instead of marching ants for non-select tool (fix commit 1b4695f)

**Issues Deferred:**

- Content-aware rotation tables for directional tiles (geometric transforms sufficient for now)
- Keyboard shortcuts for new transform tools (can add in future milestone)

**Technical Debt Incurred:**

- None — v2.5 implementation is clean with zero technical debt

---

_For current project status, see .planning/ROADMAP.md_
