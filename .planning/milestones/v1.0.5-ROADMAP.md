# Milestone v1.0.5: Settings Lifecycle Fix

**Status:** SHIPPED 2026-02-17
**Phases:** 86
**Total Plans:** 1

## Overview

Every map -- new, opened, or saved -- always carries a complete, correctly ordered description field with Format=1.1 and all 53 extended settings. Serialization logic extracted from MapSettingsDialog.tsx into a shared `settingsSerializer.ts` module consumed by creation, open, and save flows.

## Phases

### Phase 86: Settings Lifecycle

**Goal**: Every map always has complete settings in its description, regardless of how it was created, opened, or saved.
**Depends on**: Phases 1-85 (all shipped)
**Requirements**: SETT-01, SETT-02, SETT-03, SETT-04, SETT-05
**Plans**: 1 plan

Plans:

- [x] 86-01-PLAN.md -- Extract settingsSerializer.ts, wire lifecycle hooks, fix ordering

**Success Criteria** (what must be TRUE):
  1. A newly created map's description immediately contains `Format=1.1` followed by all 53 extended settings at their default values, without opening Map Settings.
  2. Opening an existing map produces a description that has all 53 extended settings present, with binary header values merged in and `Format=1.1` prefix -- even if the original file had no extended settings.
  3. Saving a map (Save or Save As) writes all 53 current settings to the description field, regardless of whether the Map Settings dialog was ever opened in the session.
  4. The description field is always ordered: `Format=1.1`, settings key-value pairs, unrecognized pairs, `Author=` last -- never any other ordering.
  5. Any unrecognized key-value pairs present in a map's existing description survive a full open-save round-trip unchanged.

---

## Milestone Summary

**Key Decisions:**

- Extracted settingsSerializer.ts from MapSettingsDialog.tsx (shared module in src/core/map/)
- buildDescription ordering fixed: unrecognized pairs BEFORE Author= (SETT-04)
- Three-layer merge priority updated: defaults < headerDerived < description (for open flow)
- 53 GAME_SETTINGS keys in description (HoldingTime stays binary-header-only)

**Issues Resolved:**

- New maps had bare "New map" description with no settings
- Opened maps retained whatever description the file contained (possibly empty)
- Saves wrote description as-is without injecting current settings
- Author= appeared before unrecognized pairs instead of last

**Issues Deferred:**

- None

**Technical Debt Incurred:**

- None

---

_For current project status, see .planning/ROADMAP.md_
